"use strict";!function(e,r){var n;"function"==typeof define&&define.amd?define(function(e,n,t){r(n)}):("object"==typeof module&&module.exports||(n=(n=(n=e.DevExpress=e.DevExpress||{}).viz=n.viz||{}).vectormaputils={}),r(n))}(this,function(e){function c(){}function l(e){return e}function p(e){return"function"==typeof e}function i(e){var n=new DataView(e),t=0,r={pos:function(){return t},skip:function(e){return t+=e,r},ui8arr:function(e){var n=0,t=[];for(t.length=e;n<e;++n)t[n]=r.ui8();return t},ui8:function(){e=t;var e=n.getUint8(e);return t+=1,e},ui16LE:function(){e=t;var e=n.getUint16(e,!0);return t+=2,e},ui32LE:function(){e=t;var e=n.getUint32(e,!0);return t+=4,e},ui32BE:function(){e=t;var e=n.getUint32(e,!1);return t+=4,e},f64LE:function(){e=t;var e=n.getFloat64(e,!0);return t+=8,e}};return r}function f(e,n,t){var r,o=e[0]?function(e,n){var t,r,o,i,u,s,a=[];try{t=new Date,(s={}).fileCode=(u=e).ui32BE(),u.skip(20),s.fileLength=u.ui32BE()<<1,s.version=u.ui32LE(),s.type_number=u.ui32LE(),s.type=h[s.type_number],s.bBox_XY=b(u),s.bBox_ZM=P(u,2),o=s}catch(e){return void n.push("shp: header parsing error: "+e.message+" / "+e.description)}9994!==o.fileCode&&n.push("shp: file code: "+o.fileCode+" / expected: 9994"),1e3!==o.version&&n.push("shp: file version: "+o.version+" / expected: 1000");try{for(;e.pos()<o.fileLength&&(i=function(e,n,t){var r={number:e.ui32BE()},o=e.ui32BE()<<1,i=e.pos(),u=e.ui32LE();r.type_number=u,r.type=h[u],r.geoJSON_type=g[r.type],r.type?(r.type!==n&&t.push("shp: shape #"+r.number+" type: "+r.type+" / expected: "+n),d[u](e,r),(i=e.pos()-i)!=o&&t.push("shp: shape #"+r.number+" length: "+o+" / actual: "+i)):(t.push("shp: shape #"+r.number+" type: "+u+" / unknown"),r=null);return r}(e,o.type,n));)a.push(i);e.pos()!==o.fileLength&&n.push("shp: file length: "+o.fileLength+" / actual: "+e.pos()),r=new Date}catch(e){n.push("shp: records parsing error: "+e.message+" / "+e.description)}return{bBox:o.bBox_XY,type:o.shapeType,shapes:a,errors:n,time:r-t}}(i(e[0]),t):{},e=e[1]?function(e,n){var t,r,o,i,u;try{t=new Date,i=function(e,n){for(var t,r,o=[],i=0,u=e.fields.length,s=0,i=0;i<u;++i)(t={name:(r=e.fields[i]).name,parser:B[r.type],length:r.length}).parser||(t.parser=E,n.push("dbf: field "+r.name+" type: "+r.type+" / unknown")),s+=r.length,o.push(t);return s+1!==e.recordLength&&n.push("dbf: record length: "+e.recordLength+" / actual: "+(s+1)),o}(o=function(e,n){var t,r,o,i,u={versionNumber:e.ui8(),lastUpdate:new Date(1900+e.ui8(),e.ui8()-1,e.ui8()),numberOfRecords:e.ui32LE(),headerLength:e.ui16LE(),recordLength:e.ui16LE(),fields:[]};for(e.skip(20),t=(u.headerLength-e.pos()-1)/32;0<t;--t)u.fields.push((i=void 0,i={name:a(o=e,11).replace(/\0*$/gi,""),type:s(o.ui8()),length:o.skip(4).ui8(),count:o.ui8()},o.skip(14),i));return 13!==(r=e.ui8())&&n.push("dbf: header terminator: "+r+" / expected: 13"),u}(e,n),n),u=function(e,n,t,r,o){for(var i,u,s,a,c=r.length,l=[],p=0;p<n;++p){for(s={},u=e.pos(),e.skip(1),i=0;i<c;++i)s[(a=r[i]).name]=a.parser(e,a.length);(u=e.pos()-u)!==t&&o.push("dbf: record #"+(p+1)+" length: "+t+" / actual: "+u),l.push(s)}return l}(e,o.numberOfRecords,o.recordLength,i,n),r=new Date}catch(e){n.push("dbf: parsing error: "+e.message+" / "+e.description)}return{records:u,errors:n,time:r-t}}(i(e[1]),t):{},t=function(e,n,t){for(var r,o=[],i=o.length=Math.max(e.length,n.length),u=0;u<i;++u)r=e[u]||{},o[u]={type:"Feature",geometry:{type:r.geoJSON_type||null,coordinates:r.coordinates?t(r.coordinates):[]},properties:n[u]||null};return o}(o.shapes||[],e.records||[],n);return t.length?(r={type:"FeatureCollection",features:t}).bbox=o.bBox:r=null,r}function n(o){return o=o||{},["shp","dbf"].map(function(r){return function(t){var e,n;o.substr?(r="."+r,e=o+(o.substr(-r.length).toLowerCase()===r?"":r),(n=new XMLHttpRequest).addEventListener("load",function(){var e,n;e=this.response?null:this.statusText,n=this.response,t(e,n)}),n.open("GET",e),n.responseType="arraybuffer",n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(null)):t(null,o[r]||null)}})}function t(e,n){var t,r=b(e),o=y(e),i=y(e),u=v(e,o),s=P(e,i),a=[];for(a.length=o,t=0;t<o;++t)a[t]=s.slice(u[t],u[t+1]||i);n.bBox=r,n.coordinates=a}function r(e,n){var t,r,o,i=b(e),u=y(e),s=y(e),a=v(e,u),c=P(e,s),l=L(e),p=m(e,s),f=[];for(f.length=u,t=0;t<u;++t)r=a[t],o=a[t+1]||s,f[t]=x(c.slice(r,o),p.slice(r,o),o-r);n.bBox=i,n.mBox=l,n.coordinates=f}function o(e,n){var t,r,o,i=b(e),u=y(e),s=y(e),a=v(e,u),c=P(e,s),l=L(e),p=m(e,s),f=L(e),h=m(e,s),d=[];for(d.length=u,t=0;t<u;++t)r=a[t],o=a[t+1]||s,d[t]=M(c.slice(r,o),p.slice(r,o),h.slice(r,o),o-r);n.bBox=i,n.zBox=l,n.mBox=f,n.coordinates=d}e.parse=function(e,t,r){var o,i,u,s;function a(){var e,n;0===--s&&(e=u,r=p(t)&&t||p(r)&&r||c,t=!p(t)&&t||{},n=[],i.forEach(function(e){e&&n.push(e)}),o=f(e,0<=t.precision?function(e){var n=Number("1E"+e);function t(e){return Math.round(e*n)/n}return function e(n){return n.map(n[0].length?e:t)}}(t.precision):l,n),r(o,n.length?n:null))}return e=n(e),i=[],u=[],s=1,e.forEach(function(e,t){++s,e(function(e,n){i[t]=e,u[t]=n,a()})}),a(),o};var h={0:"Null",1:"Point",3:"PolyLine",5:"Polygon",8:"MultiPoint",11:"PointZ",13:"PolyLineZ",15:"PolygonZ",18:"MultiPointZ",21:"PointM",23:"PolyLineM",25:"PolygonM",28:"MultiPointM",31:"MultiPatch"},d={0:c,1:function(e,n){n.coordinates=P(e,1)[0]},3:t,5:t,8:function(e,n){n.bBox=b(e),n.coordinates=P(e,y(e))},11:function(e,n){n.coordinates=P(e,1)[0],n.push(m(e,1)[0],m(e,1)[0])},13:o,15:o,18:function(e,n){var t=b(e),r=y(e),o=P(e,r),i=L(e),u=m(e,r),s=L(e),e=m(e,r);n.bBox=t,n.zBox=i,n.mBox=s,n.coordinates=M(o,u,e,r)},21:function(e,n){n.coordinates=P(e,1)[0],n.coordinates.push(m(e,1)[0])},23:r,25:r,28:function(e,n){var t=b(e),r=y(e),o=P(e,r),i=L(e),e=m(e,r);n.bBox=t,n.mBox=i,n.coordinates=x(o,e,r)},31:function(e,n){var t,r,o,i=b(e),u=y(e),s=y(e),a=v(e,u),c=v(e,u),l=P(e,s),p=L(e),f=m(e,s),e=L(e),h=[];for(h.length=u,t=0;t<u;++t)r=a[t],o=a[t+1]||s,h[t]=M(l.slice(r,o),f.slice(r,o),mValues.slice(r,o),o-r);n.bBox=i,n.zBox=p,n.mBox=e,n.types=c,n.coordinates=h}},g={Null:"Null",Point:"Point",PolyLine:"MultiLineString",Polygon:"Polygon",MultiPoint:"MultiPoint",PointZ:"Point",PolyLineZ:"MultiLineString",PolygonZ:"Polygon",MultiPointZ:"MultiPoint",PointM:"Point",PolyLineM:"MultiLineString",PolygonM:"Polygon",MultiPointM:"MultiPoint",MultiPatch:"MultiPatch"};function y(e){return e.ui32LE()}function v(e,n){var t,r=[];for(r.length=n,t=0;t<n;++t)r[t]=y(e);return r}function m(e,n){var t,r=[];for(r.length=n,t=0;t<n;++t)r[t]=e.f64LE();return r}function b(e){return m(e,4)}function L(e){return[e.f64LE(),e.f64LE()]}function P(e,n){var t,r=[];for(r.length=n,t=0;t<n;++t)r[t]=L(e);return r}function x(e,n,t){var r,o=[];for(o.length=t,r=0;r<t;++r)o[r]=[e[r][0],e[r][1],n[r]];return o}function M(e,n,t,r){var o,i=[];for(i.length=r,o=0;o<r;++o)i[o]=[e[o][0],e[o][1],n[o],t[o]];return i}var s=String.fromCharCode;function a(e,n){return s.apply(null,e.ui8arr(n))}var B={C:function(e,n){e=a(e,n);try{e=decodeURIComponent(escape(e))}catch(e){}return e.trim()},N:function(e,n){e=a(e,n);return parseFloat(e)},D:function(e,n){e=a(e,n);return new Date(e.substring(0,4),e.substring(4,6)-1,e.substring(6,8))}};function E(e,n){return e.skip(n),null}});